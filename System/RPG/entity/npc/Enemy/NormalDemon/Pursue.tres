[gd_resource type="BehaviorTree" load_steps=29 format=3 uid="uid://dw3ywrr6pnj8o"]

[ext_resource type="Script" uid="uid://ruy6igvdnadx" path="res://Scripts/system/ai/tasks/get_first_in_group.gd" id="1_pk82o"]
[ext_resource type="Script" uid="uid://cpgmrr2q5ku7l" path="res://Scripts/system/ai/tasks/get_target_distance.gd" id="2_y6ake"]
[ext_resource type="Script" uid="uid://duholooqx2vum" path="res://Scripts/system/ai/tasks/get_detector.gd" id="3_1yeq0"]
[ext_resource type="Script" uid="uid://c31p6xk5rsnqg" path="res://Scripts/system/ai/tasks/is_caught_by_light.gd" id="3_tftqv"]
[ext_resource type="Script" uid="uid://c005nfeib46uc" path="res://Scripts/system/ai/tasks/pursue.gd" id="5_1yeq0"]

[sub_resource type="BlackboardPlan" id="BlackboardPlan_ilc2e"]
var/speed/name = &"speed"
var/speed/type = 3
var/speed/value = 300.0
var/speed/hint = 0
var/speed/hint_string = ""

[sub_resource type="BTConsolePrint" id="BTConsolePrint_1yeq0"]
text = "NowBTState : Pursue"

[sub_resource type="BTAction" id="BTAction_tftqv"]
script = ExtResource("3_1yeq0")

[sub_resource type="BTAction" id="BTAction_7clef"]
script = ExtResource("1_pk82o")
group = &"player"

[sub_resource type="BTAction" id="BTAction_1yeq0"]
script = ExtResource("2_y6ake")

[sub_resource type="BBVariant" id="BBVariant_tftqv"]
type = 3
saved_value = 500.0
resource_name = "500.0"

[sub_resource type="BTCheckVar" id="BTCheckVar_7clef"]
variable = &"target_distance"
check_type = 3
value = SubResource("BBVariant_tftqv")
custom_name = "目标感知范围"

[sub_resource type="BBVariant" id="BBVariant_5t1gq"]
type = 4
saved_value = "pursue"
resource_name = "pursue"

[sub_resource type="BBNode" id="BBNode_h843t"]
saved_value = NodePath("AnimatedSprite")
resource_name = "AnimatedSprite"

[sub_resource type="BTCallMethod" id="BTCallMethod_rxbbq"]
node = SubResource("BBNode_h843t")
method = &"play"
args = Array[BBVariant]([SubResource("BBVariant_5t1gq")])

[sub_resource type="BTCondition" id="BTCondition_7clef"]
script = ExtResource("3_tftqv")

[sub_resource type="BBNode" id="BBNode_tftqv"]
saved_value = NodePath("LimboHSM")
resource_name = "LimboHSM"

[sub_resource type="BTCallMethod" id="BTCallMethod_7clef"]
node = SubResource("BBNode_tftqv")
method = &"_dispatch_light_detected"

[sub_resource type="BTSequence" id="BTSequence_gu11r"]
custom_name = "to flee"
children = [SubResource("BTCondition_7clef"), SubResource("BTCallMethod_7clef")]

[sub_resource type="BTAlwaysSucceed" id="BTAlwaysSucceed_alxfv"]
children = [SubResource("BTSequence_gu11r")]

[sub_resource type="BTAction" id="BTAction_gu11r"]
script = ExtResource("5_1yeq0")
approach_distance = 50.0

[sub_resource type="BTTimeLimit" id="BTTimeLimit_l5cvy"]
time_limit = 0.1
children = [SubResource("BTAction_gu11r")]

[sub_resource type="BTSequence" id="BTSequence_ft3k3"]
custom_name = "pursue"
children = [SubResource("BTCallMethod_rxbbq"), SubResource("BTAlwaysSucceed_alxfv"), SubResource("BTTimeLimit_l5cvy")]

[sub_resource type="BTAlwaysFail" id="BTAlwaysFail_ec12m"]
children = [SubResource("BTSequence_ft3k3")]

[sub_resource type="BTSelector" id="BTSelector_7clef"]
children = [SubResource("BTCheckVar_7clef"), SubResource("BTAlwaysFail_ec12m")]

[sub_resource type="BTSequence" id="BTSequence_7clef"]
custom_name = "pursue loop"
children = [SubResource("BTAction_1yeq0"), SubResource("BTSelector_7clef")]

[sub_resource type="BTRepeatUntilSuccess" id="BTRepeatUntilSuccess_gu11r"]
children = [SubResource("BTSequence_7clef")]

[sub_resource type="BTSequence" id="BTSequence_pk82o"]
custom_name = "normal_demon"
children = [SubResource("BTConsolePrint_1yeq0"), SubResource("BTAction_tftqv"), SubResource("BTAction_7clef"), SubResource("BTRepeatUntilSuccess_gu11r")]

[resource]
blackboard_plan = SubResource("BlackboardPlan_ilc2e")
root_task = SubResource("BTSequence_pk82o")
